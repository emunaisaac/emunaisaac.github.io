<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Bus Ticket Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: linear-gradient(135deg, #0f172a, #1e293b);
      --card: rgba(255, 255, 255, 0.05);
      --muted: #94a3b8;
      --accent: #6366f1;
      --accent-2: #06b6d4;
      --text: #f8fafc;
      --radius: 16px;
      --shadow: 0 8px 32px rgba(0, 0, 0, 0.35);
      --container: 1100px;
    }
    body.light {
      --bg: linear-gradient(135deg, #f8fafc, #e2e8f0);
      --card: rgba(0, 0, 0, 0.05);
      --muted: #475569;
      --text: #1e293b;
      --shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: "Inter", sans-serif; background: var(--bg); color: var(--text); transition: .4s; }
    .container { width: min(92%, var(--container)); margin: 0 auto; }
    header { position: sticky; top: 0; z-index: 50; backdrop-filter: blur(12px); background: rgba(15, 23, 42, .6); border-bottom: 1px solid rgba(255, 255, 255, .05); transition: .4s; }
    body.light header { background: rgba(255, 255, 255, .7); }
    .nav-inner { display: flex; align-items: center; justify-content: space-between; padding: 1rem 0; }
    .logo { font-weight: 700; font-size: 1.2rem; text-decoration: none; color: var(--text); }
    nav ul { display: flex; gap: 1.5rem; list-style: none; }
    nav a { text-decoration: none; color: var(--muted); transition: .3s; }
    nav a:hover { color: var(--accent); }
    .menu-toggle { display: none; font-size: 1.6rem; cursor: pointer; color: var(--text); }
    .btn { padding: .7rem 1.2rem; border-radius: var(--radius); text-decoration: none; font-weight: 600; cursor: pointer; transition: .3s; }
    .btn-primary { background: linear-gradient(90deg, var(--accent), var(--accent-2)); color: white; box-shadow: 0 6px 20px rgba(99, 102, 241, .4); }
    .btn-outline { border: 2px solid var(--accent); color: var(--accent); }
    .btn-outline:hover { background: var(--accent); color: white; }
    .hero { text-align: center; padding: 5rem 0; }
    .hero h1 { font-size: clamp(2rem, 6vw, 3rem); margin-bottom: 1rem; }
    .hero p { color: var(--muted); margin-bottom: 2rem; }
    .section { padding: 4rem 0; }
    .section h2 { text-align: center; font-size: 1.8rem; margin-bottom: .5rem; }
    .section p.lead { text-align: center; color: var(--muted); margin: 0 auto 2.5rem; max-width: 600px; }
    .card { background: var(--card); padding: 2rem; border-radius: var(--radius); box-shadow: var(--shadow); transition: .3s; }
    .card:hover { transform: translateY(-6px); }
    .form-group { margin-bottom: 1rem; }
    .form-group label { display: block; margin-bottom: .4rem; font-weight: 600; }
    input, select { width: 100%; padding: .7rem; border-radius: 10px; border: 1px solid rgba(255, 255, 255, .1); background: rgba(255, 255, 255, .03); color: var(--text); }
    body.light input, body.light select { border: 1px solid rgba(0, 0, 0, .1); background: rgba(0, 0, 0, .03); }
    .ticket { margin-top: 2rem; padding: 2rem; border-radius: var(--radius); background: var(--card); box-shadow: var(--shadow); display: none; animation: fadeIn .6s; }
    .ticket-actions { margin-top: 1rem; display: flex; gap: 1rem; }
    .qr { margin-top: 1rem; text-align: center; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    footer { padding: 2rem 0; text-align: center; color: var(--muted); }
    .toggle-btn { border: 2px solid var(--accent); border-radius: 50%; width: 40px; height: 40px; background: none; color: var(--accent); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: .3s; }
    .toggle-btn:hover { background: var(--accent); color: white; }
    #backToTop { position: fixed; bottom: 30px; right: 30px; background: var(--accent); color: white; border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; font-size: 1.2rem; display: none; align-items: center; justify-content: center; box-shadow: var(--shadow); }
    #backToTop.show { display: flex; }
    @media(max-width:768px) {
      nav { display: none; position: absolute; top: 100%; right: 0; background: var(--card); backdrop-filter: blur(12px); padding: 1rem; border-radius: var(--radius); }
      nav.active { display: block; }
      nav ul { flex-direction: column; gap: 1rem; }
      .menu-toggle { display: block; }
    }
  </style>
</head>
<body>
  <header>
    <div class="container nav-inner">
      <a href="index.html" class="logo">üöå BusTickets</a>
      <div class="menu-toggle" id="menu-toggle">‚ò∞</div>
      <nav id="nav">
        <ul>
          <li><a href="#book">Book Ticket</a></li>
          <li><a href="#about">About</a></li>
          <li><a href="#scanner">QR Code Scanner</a></li>
        </ul>
      </nav>
      <button class="toggle-btn" id="toggle-theme">üåô</button>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container">
        <h1>Book Your Bus Ticket</h1>
        <p>Fast, simple, and beautiful way to reserve your seat.</p>
        <a href="#book" class="btn btn-primary">Start Booking</a>
      </div>
    </section>

    <section id="book" class="section">
      <div class="container">
        <h2>Ticket Generator</h2>
        <p class="lead">Fill the form below to get your digital ticket üéüÔ∏è</p>
        <div class="card">
          <form id="ticket-form">
            <div class="form-group"><label>Passenger Name</label><input type="text" id="name" required></div>
            <div class="form-group"><label>From</label><input type="text" id="from" required></div>
            <div class="form-group"><label>To</label><input type="text" id="to" required></div>
            <div class="form-group"><label>Date</label><input type="date" id="date" required></div>
            <div class="form-group"><label>Time of Arrival</label><input type="time" id="arrivalTime" required></div>
            <div class="form-group"><label>Seat Number</label><input type="number" id="seat" required min="1"></div>
            <div class="form-group"><label>Bus Type</label>
              <select id="bus">
                <option value="Standard">Standard</option>
                <option value="Luxury">Luxury</option>
                <option value="Sleeper">Sleeper</option>
              </select>
            </div>
            <button type="submit" class="btn btn-primary">Generate Ticket</button>
          </form>
          <div class="ticket" id="ticket"></div>
        </div>
      </div>
    </section>

    <section id="about" class="section">
      <div class="container">
        <h2>About</h2>
        <p class="lead">This system provides an easy way to book bus tickets online with instant ticket generation, QR code, download & print.</p>
      </div>
    </section>

    <section id="scanner" class="section">
      <div class="container">
        <h2>QR Code Scanner</h2>
        <p class="lead">Scan your ticket QR code to verify your ticket.</p>
        <div class="card">
          <video id="preview" width="100%" height="auto"></video>
          <button id="startScan" class="btn btn-primary">Start Scanning</button>
          <div id="scanResult" class="ticket" style="display:none;"></div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>¬© <span id="year"></span> BusTickets. Made with ‚ù§Ô∏è</p>
  </footer>
  <button id="backToTop">‚¨Ü</button>

  <!-- QRCode.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <!-- QR Scanner -->
  <script src="https://unpkg.com/@zxing/library@latest"></script>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // Theme toggle
    const toggle = document.getElementById("toggle-theme");
    toggle.addEventListener("click", () => {
      document.body.classList.toggle("light");
      toggle.textContent = document.body.classList.contains("light") ? "‚òÄÔ∏è" : "üåô";
    });

    // Mobile menu
    document.getElementById("menu-toggle").addEventListener("click", () => {
      document.getElementById("nav").classList.toggle("active");
    });

    // Ticket generator
    const form = document.getElementById("ticket-form");
    const ticket = document.getElementById("ticket");
    form.addEventListener("submit", e => {
      e.preventDefault();
      const name = document.getElementById("name").value;
      const from = document.getElementById("from").value;
      const to = document.getElementById("to").value;
      const date = document.getElementById("date").value;
      const arrivalTime = document.getElementById("arrivalTime").value;
      const seat = document.getElementById("seat").value;
      const bus = document.getElementById("bus").value;
      const ticketNo = "TKT-" + Math.floor(Math.random() * 1000000);

      // Security: Validate input
      if (!name || !from || !to || !date || !arrivalTime || !seat || !bus) {
        alert("Please fill in all fields.");
        return;
      }

      ticket.style.display = "block";
      ticket.innerHTML = `
        <div id="ticket-content">
          <h3>üéüÔ∏è Your Bus Ticket</h3>
          <p><strong>Ticket No:</strong> ${ticketNo}</p>
          <p><strong>Name:</strong> ${name}</p>
          <p><strong>From:</strong> ${from} ‚Üí <strong>To:</strong> ${to}</p>
          <p><strong>Date:</strong> ${date}</p>
          <p><strong>Time of Arrival:</strong> ${arrivalTime}</p>
          <p><strong>Seat:</strong> ${seat}</p>
          <p><strong>Bus:</strong> ${bus}</p>
          <p>‚úÖ Please arrive 15 mins before departure.</p>
          <div class="qr"><div id="qrcode"></div></div>
        </div>
        <div class="ticket-actions">
          <button class="btn btn-outline" id="downloadPDF">‚¨áÔ∏è Download PDF</button>
          <button class="btn btn-outline" id="printTicket">üñ®Ô∏è Print</button>
        </div>
      `;
      form.reset();

      // Generate QR Code
      const qrText = `Ticket No: ${ticketNo}\nName: ${name}\nFrom: ${from}\nTo: ${to}\nDate: ${date}\nTime: ${arrivalTime}\nSeat: ${seat}\nBus: ${bus}`;
      new QRCode(document.getElementById("qrcode"), {
        text: qrText,
        width: 128,
        height: 128,
        colorDark: "#000",
        colorLight: "#fff",
        correctLevel: QRCode.CorrectLevel.H
      });

      // Download PDF
      document.getElementById("downloadPDF").addEventListener("click", () => {
        const element = document.getElementById("ticket-content");
        html2pdf().from(element).set({
          margin: 10,
          filename: ticketNo + ".pdf",
          html2canvas: { scale: 2 },
          jsPDF: { unit: "mm", format: "a4", orientation: "portrait" }
        }).save();
      });

      // Print Ticket
      document.getElementById("printTicket").addEventListener("click", () => {
        const printWindow = window.open("", "Print Ticket", "width=600,height=800");
        printWindow.document.write("<html><head><title>Print Ticket</title></head><body>");
        printWindow.document.write(document.getElementById("ticket-content").innerHTML);
        printWindow.document.write("</body></html>");
        printWindow.document.close();
        printWindow.print();
      });
    });

    // QR Code Scanner
    const codeReader = new ZXing.BrowserQRCodeReader();
    const preview = document.getElementById("preview");
    const startScanButton = document.getElementById("startScan");
    const scanResult = document.getElementById("scanResult");

    startScanButton.addEventListener("click", () => {
      codeReader.decodeFromVideoDevice(null, preview, (result, err) => {
        if (result) {
          scanResult.style.display = "block";
          scanResult.innerHTML = `<h3>Scan Result:</h3><p>${result.text}</p>`;
        }
        if (err && !(err instanceof ZXing.NotFoundException)) {
          console.error(err);
        }
      });
    });

    // Back to top
    const backToTop = document.getElementById("backToTop");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 400) backToTop.classList.add("show");
      else backToTop.classList.remove("show");
    });
    backToTop.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));
  </script>
</body>
</html>
